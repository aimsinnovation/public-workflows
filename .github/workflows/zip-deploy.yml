name: Deploy via scm

on:
  workflow_call:
    secrets: 
      scm_auth:
        required: true
    inputs: 
      scm_url:
        required: true
        type: string
      artifact_name: 
        required: true
        type: string

jobs:
  deployment:
    runs-on: ubuntu-latest
    steps: 
    - name: "Download artifact"
      uses: actions/download-artifact@v3
      with:
        name: ${{ inputs.artifact_name }}

    - name: "Deploy azure"
      run: | 
        curl --progress-meter -X POST -u "${{ secrets.scm_auth }}" ${{ inputs.scm_url }} -T "app.zip" > /dev/null